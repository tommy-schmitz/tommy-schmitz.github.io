(() => {
  const exported_code = {"main":"(() => {\n\nwindow.modules = {};\n\neval(localStorage.getItem('code_env module use_localStorage_state'));\neval(localStorage.getItem('code_env module render_main_menu'));\neval(localStorage.getItem('code_env module render_tic_tac_toe'));\neval(localStorage.getItem('code_env module create_square'));\neval(localStorage.getItem('code_env module render_one_module'));\neval(localStorage.getItem('code_env module render_module_list'));\neval(localStorage.getItem('code_env module render'));\n\nconst t_state = window.modules.use_localStorage_state('code_env tic tac toe state');\nif(t_state.get_state() === undefined)\n  t_state.set_state({squares: '         ', turn: 'x', victory_state: ' '});\n\nwindow.ui_state = {type: 'one module', module_name: 'main'};\n\nwindow.modules.render();\n\n})()","render_module_list":"window.modules.render_module_list = () => {\n  const module_list_string = localStorage.getItem('code_env modules list') || '{\"main\":1}';\n  const module_list_object = JSON.parse(module_list_string);\n  const module_list = Object.keys(module_list_object);\n\n  const back_button = document.createElement('button');\n  back_button.innerText = 'Back to main menu';\n  back_button.addEventListener('click', () => {\n    window.ui_state = {type: 'main menu'};\n    window.modules.render();\n  });\n  document.body.appendChild(back_button);\n\n  const div_1 = document.createElement('div');\n  document.body.appendChild(div_1);\n  const text_node = document.createTextNode('Enter name of module to be opened:');\n  div_1.appendChild(text_node);\n  const input = document.createElement('input');\n  div_1.appendChild(input);\n  const button = document.createElement('button');\n  button.innerText = 'Open';\n  button.addEventListener('click', () => {\n localStorage.setItem('code_env modules list', JSON.stringify({...module_list_object, [input.value]: 1}));\n    window.ui_state = {type: 'one module', module_name: input.value};\n    window.modules.render();\n  });\n  div_1.appendChild(button);\n\n  const div_2 = document.createElement('div');\n  div_2.innerText = 'List of modules:';\n  Object.assign(div_2.style, {marginTop: '20px', marginBottom: '20px'});\n  document.body.appendChild(div_2);\n\n  const div_3 = document.createElement('div');\n  for(const module_name of module_list) {\n    const div_4 = document.createElement('div');\n    const text_node_2 = document.createTextNode(module_name);\n    div_4.appendChild(text_node_2);\n    const button_2 = document.createElement('button');\n    button_2.innerText = 'Open';\n    Object.assign(button_2.style, {marginLeft: '20px'});\n    button_2.addEventListener('click', () => {\n      window.ui_state = {type: 'one module', module_name};\n      window.modules.render();\n    });\n    div_4.appendChild(button_2);\n    div_3.appendChild(div_4);\n  }\n  document.body.appendChild(div_3);\n};","render_one_module":"window.modules.render_one_module = ({module_name}) => {\nconst div_3 = document.createElement('div');\ndiv_3.innerText = 'Module name: ' + module_name;\ndocument.body.appendChild(div_3);\n\nconst div_0 = document.createElement('div');\ndocument.body.appendChild(div_0);\nconst textarea = document.createElement('textarea');\ntextarea.value = localStorage.getItem('code_env module ' + module_name);\nObject.assign(textarea.style, {  width: '100%',  height: '75vh',});\ndiv_0.appendChild(textarea);\n\nconst div_1 = document.createElement('div');\ndocument.body.appendChild(div_1);\nconst button_1 = document.createElement('button');\nbutton_1.innerText = 'Save and close';\nbutton_1.addEventListener('click', () => {\n  localStorage.setItem('code_env module '+module_name, textarea.value);\n  window.ui_state = {type: 'module list'};\n  window.modules.render();\n});\ndiv_1.appendChild(button_1);\n\nconst div_2 = document.createElement('div');\ndocument.body.appendChild(div_2);\nconst button_2 = document.createElement('button');\nbutton_2.innerText = 'Execute';\nbutton_2.addEventListener('click', () => {  eval(textarea.value);});\ndiv_2.appendChild(button_2);\n};","test_1":"console.log('hello world');","render":"window.modules.render = () => {\n  document.body.innerHTML = '';\n\n  if(window.ui_state.type === 'module list') {\n    window.modules.render_module_list(window.ui_state);\n  } else if(window.ui_state.type === 'one module') {\n    window.modules.render_one_module(window.ui_state);\n  } else if(window.ui_state.type === 'tic tac toe') {\n    window.modules.render_tic_tac_toe(window.ui_state);\n  } else if(window.ui_state.type === 'main menu') {\n    window.modules.render_main_menu(window.ui_state);\n  } else {\n    console.error('unrecognized ui_state');\n  }\n};","backup_main_1":"(() => {\n\nconsole.log('Beginning executing code.');\n\nconst render_one_module = ({module_name}) => {\n\nconst div_3 = document.createElement('div');\ndiv_3.innerText = 'Module name: ' + module_name;\ndocument.body.appendChild(div_3);\n\nconst div_0 = document.createElement('div');\ndocument.body.appendChild(div_0);\nconst textarea = document.createElement('textarea');\ntextarea.value = localStorage.getItem('code_env module ' + module_name);\nObject.assign(textarea.style, {\n  width: '100%',\n  height: '75vh',\n});\ndiv_0.appendChild(textarea);\n\nconst div_1 = document.createElement('div');\ndocument.body.appendChild(div_1);\nconst button_1 = document.createElement('button');\nbutton_1.innerText = 'Save and close';\nbutton_1.addEventListener('click', () => {\n  localStorage.setItem('code_env module '+module_name, textarea.value);\n  window.ui_state = {type: 'module list'};\n  render();\n});\ndiv_1.appendChild(button_1);\n\nconst div_2 = document.createElement('div');\ndocument.body.appendChild(div_2);\nconst button_2 = document.createElement('button');\nbutton_2.innerText = 'Execute';\nbutton_2.addEventListener('click', () => {\n  eval(textarea.value);\n});\ndiv_2.appendChild(button_2);\n\n};\n\nwindow.modules.render_module_list = () => {\n  const div_1 = document.createElement('div');\n  document.body.appendChild(div_1);\n  const text_node = document.createTextNode('Enter name of module to be opened:');\n  div_1.appendChild(text_node);\n  const input = document.createElement('input');\n  div_1.appendChild(input);\n  const button = document.createElement('button');\n  button.innerText = 'Open';\n  button.addEventListener('click', () => {\n    window.ui_state = {type: 'one module', module_name: input.value};\n    render();\n  });\n  div_1.appendChild(button);\n\n  const module_list_string = localStorage.getItem('code_env modules list') || '[\"main\"]';\n  const module_list = JSON.parse(module_list_string);\n\n  const div_2 = document.createElement('div');\n  div_2.innerText = '\\nList of modules:\\n\\n' + module_list.join(' ; \\n');\n  document.body.appendChild(div_2);\n};\n\nconst render = () => {\n  document.body.innerHTML = '';\n\n  if(window.ui_state.type === 'module list') {\n    render_module_list(window.ui_state);\n  } else if(window.ui_state.type === 'one module') {\n    render_one_module(window.ui_state);\n  } else {\n    console.error('unrecognized ui_state');\n  }\n};\n\nrender();\n\nconsole.log('Finished executing code.');\n\n})()\n","test_2":"","export_all_code":"window.modules.export_all_code = () => {\n  const module_list_string = localStorage.getItem('code_env modules list') || '{\"main\":1}';\n  const module_list_object = JSON.parse(module_list_string);\n  const module_list = Object.keys(module_list_object);\n\n  const data_to_export = {};\n  for(const module_name of module_list) {\n    data_to_export[module_name] = localStorage.getItem('code_env module ' + module_name);\n  }\n\n  const output_text = `\\\n(() => {\n  const exported_code = ${JSON.stringify(data_to_export)};\n  const modules_object = {};\n  for(const key in exported_code) {\n    modules_object[key] = 1;\n    localStorage.setItem('code_env module ' + key, exported_code[key]);\n  }\n  localStorage.setItem('code_env modules list', JSON.stringify(modules_object));\n  eval(exported_code.main);\n})();\n  `;\n\n  console.log({output_text});\n};\n\nwindow.modules.export_all_code();\n","use_localStorage_state":"window.modules.use_localStorage_state = (key) => {\n  const get_state = () => {\n    const stuff = localStorage.getItem(key);\n    if(stuff === null)\n      return undefined;\n    else\n      return JSON.parse(stuff);\n  };\n  const set_state = (arg) => {\n    localStorage.setItem(key, JSON.stringify(arg));\n    window.modules.render();\n  };\n  return {get_state, set_state};\n};\n","render_tic_tac_toe":"window.modules.render_tic_tac_toe = () => {\n  const back_button = document.createElement('button');\n  back_button.innerText = 'Back to main menu';\n  back_button.addEventListener('click', () => {\n    window.ui_state = {type: 'main menu'};\n    window.modules.render();\n  });\n  document.body.appendChild(back_button);\n\n  const {get_state, set_state} = window.modules.use_localStorage_state('code_env tic tac toe state');\n  const state = get_state();\n\n  const div_0 = document.createElement('div');\n  if(state.victory_state === ' ')\n    div_0.innerText = 'Current turn: ' + state.turn;\n  else\n    div_0.innerText = 'Game is finished! Victor: ' + state.victory_state;\n  document.body.appendChild(div_0);\n\n  const create_square = window.modules.create_square;\n\n  const div_1 = document.createElement('div');\n  {\n    const div = div_1;\n    div.appendChild(create_square(7).div);\n    div.appendChild(create_square(2).div);\n    div.appendChild(create_square(3).div);\n  }\n  document.body.appendChild(div_1);\n\n  const div_2 = document.createElement('div');\n  {\n    const div = div_2;\n    div.appendChild(create_square(0).div);\n    div.appendChild(create_square(4).div);\n    div.appendChild(create_square(8).div);\n  }\n  document.body.appendChild(div_2);\n\n  const div_3 = document.createElement('div');\n  {\n    const div = div_3;\n    div.appendChild(create_square(5).div);\n    div.appendChild(create_square(6).div);\n    div.appendChild(create_square(1).div);\n  }\n  document.body.appendChild(div_3);\n\n  const reset_button = document.createElement('button');\n  reset_button.innerText = 'Reset the game';\n  reset_button.addEventListener('click', () => {\n    set_state({squares: '         ', turn: 'x', victory_state: ' '});\n  });\n  document.body.appendChild(reset_button);\n};\n","render_main_menu":"window.modules.render_main_menu = () => {\n  const button_1 = document.createElement('button');\n  button_1.innerText = 'Code editor';\n  button_1.addEventListener('click', () => {\n    window.ui_state = {type: 'module list'};\n    window.modules.render();\n  });\n  document.body.appendChild(button_1);\n\n  document.body.appendChild(document.createElement('br'));\n\n  const button_2 = document.createElement('button');\n  button_2.innerText = 'Play tic tac toe';\n  button_2.addEventListener('click', () => {\n    window.ui_state = {type: 'tic tac toe'};\n    window.modules.render();\n  });\n  document.body.appendChild(button_2);\n};\n","create_square":"window.modules.create_square = (index) => {\n  const {get_state, set_state} = window.modules.use_localStorage_state('code_env tic tac toe state');\n  const state = get_state();\n\n  const div = document.createElement('div');\n  div.innerText = state.squares[index];\n  Object.assign(div.style, {\n    display: 'inline-block',\n    verticalAlign: 'top',\n    width: '18px',\n    height: '18px',\n    border: '1px solid black',\n    padding: '15px',\n  });\n  div.addEventListener('click', () => {\n    if(state.squares[index] !== ' ')\n      return;\n    if(state.victory_state !== ' ')\n      return;\n    const new_squares =\n        state.squares.slice(0, index)\n      + state.turn\n      + state.squares.slice(index + 1)\n    ;\n    const new_turn = ((state.turn === 'x') ? 'o' : 'x');\n    const new_victory_state = (() => {\n      const s = new_squares;\n      for(let i=0; i<9; ++i)\n        for(let j=i+1; j<9; ++j) {\n          const k = 12 - i - j;\n          if(k !== i  &&  k !== j  &&  s[i] !== ' '  &&  s[i] === s[j]  &&  s[j] === s[k])\n            return s[i];\n        }\n      return ' ';\n    })();\n    set_state({squares: new_squares, turn: new_turn, victory_state: new_victory_state});\n  });\n\n  return {div};\n};\n"};
  const modules_object = {};
  for(const key in exported_code) {
    modules_object[key] = 1;
    localStorage.setItem('code_env module ' + key, exported_code[key]);
  }
  localStorage.setItem('code_env modules list', JSON.stringify(modules_object));
  eval(exported_code.main);
})();
  
